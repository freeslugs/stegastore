<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>File Upload Serverless</title>
  <style>
    div { margin-bottom: 10px; }
    #drop { padding: 20px; border: 2px dashed #888; color: #888; }
  </style>
</head>
<body>

<div id="drop">Drop files here</div>
<input id="select" type="file" name="files[]" multiple />
<div id="info"></div>
<div id="result"></div>

<script src="./dist/pngdrive-min.js"></script>

<script>
  var pngdrive = new PNGDrive();
  var dropEl = document.getElementById("drop");
  var selectEl = document.getElementById("select");
  var infoEl = document.getElementById("info");
  var resultEl = document.getElementById("result");
  dropEl.addEventListener('drop', dropHandler, false);
  function dropHandler(event) {
    event.preventDefault();
    event.stopPropagation();
    var files = event.dataTransfer.files;
    for (var i = 0, file; file = files[i]; i++) {
      pngdrive.addFile(file);
    }
    pngdrive.encode(function() {
      var img = this.createImage();
      var imgDataURL = img.toDataURL();
      resultEl.innerHTML = '<img src="' + imgDataURL + '" />';
      var numFiles = this.getFileCount();
      infoEl.innerHTML = 'Encoded ' + numFiles + ' Files';
    });
  }
  selectEl.addEventListener('change', selectHandler, false);
  function selectHandler(event) {
    var fl = event.target.files;
    for (var i = 0, f; f = fl[i]; i++) {
      pngdrive.addFile(f);
    }
    pngdrive.encode(function() {
      var img = this.createImage();
      var imgDataURL = img.toDataURL();
      resultEl.innerHTML = '<img src="' + imgDataURL + '" />';
      var numFiles = this.getFileCount();
      infoEl.innerHTML = 'Encoded ' + numFiles + ' Files';
    });
  }
</script>
</body>
</html>
